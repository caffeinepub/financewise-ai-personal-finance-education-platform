{
  "kind": "build_request",
  "title": "Prevent wrong-version deployments and support verified rebuild of version 242",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add a single, explicit application version identifier that can be set at build time and surfaced in the UI so operators can verify that the deployed build is version 242 (and not 244).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Rebuild version 242 now"
        ]
      },
      "acceptanceCriteria": [
        "A build-time version string can be configured without code changes (e.g., via a frontend env/build constant).",
        "The app displays the configured version string in at least one always-visible location (e.g., footer) in both public and authenticated areas.",
        "The displayed version string exactly matches the configured build version (e.g., \"242\") after rebuild."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Implement the currently-empty Deployment Info page to show build/version information (and any other locally-available build metadata) so reviewers can confirm the running version in draft and production.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Rebuild version 242 now"
        ]
      },
      "acceptanceCriteria": [
        "The previously empty `frontend/src/pages/DeploymentInfo.tsx` renders a page with a clear title and a version field.",
        "A route exists that allows navigating to the Deployment Info page in the running app (public or authenticated is acceptable, but it must be reachable without editing immutable paths).",
        "The version shown on the Deployment Info page matches the version shown in the always-visible location from REQ-1."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Expose a backend query method that returns a backend build/version identifier so the frontend can display both frontend and backend versions for deployment verification when rebuilding version 242.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Rebuild version 242 now"
        ]
      },
      "acceptanceCriteria": [
        "Backend provides a query function that returns a version string (e.g., \"242\").",
        "The function is callable without trapping for authenticated users; if access control is required, document the expected role/permission clearly in code comments.",
        "Frontend Deployment Info page displays both frontend version and backend version and makes it obvious if they differ."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Add a lightweight deployment safety check in the frontend that warns the user when the displayed build version is not the requested target version \"242\" (to reduce the risk of mistakenly reviewing/publishing 244 again).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Rebuild version 242 now"
        ]
      },
      "acceptanceCriteria": [
        "When the configured build version is anything other than \"242\", the app shows a clear warning message on the Deployment Info page (English text).",
        "When the configured build version is \"242\", no warning is shown.",
        "The warning does not block normal app usage; it is informational only."
      ]
    }
  ],
  "constraints": [
    "Use English for any user-facing text.",
    "Do not edit files under `frontend/src/components/ui` (compose them instead).",
    "Do not edit immutable frontend hook paths listed in SYSTEM_CONTEXT.",
    "Do not modify quiz-related files unless fixing critical bugs (per `frontend/src/requirements/REQ-10-quiz-no-changes.md`).",
    "Backend must remain a single Motoko actor (`backend/main.mo`); only add `backend/migration.mo` if a stable-state upgrade is required (it should not be for version endpoints)."
  ],
  "nonGoals": [
    "Automating or executing the actual platform rollback/redeploy operation to draft/production environments (operational task outside the codebase).",
    "Implementing CI/CD pipelines, Git tag checkout, or external deployment tooling integrations.",
    "Changing existing finance features (analytics, budget planner, blog, quiz content) beyond adding version visibility and deployment verification."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}